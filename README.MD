# CobaltStrike Beacon Source Code  / CobaltStrike Beacon æºä»£ç  ï¼ˆæ­£åœ¨æ”¹è¿›ï¼Œå®ç°ç°ä»£åŒ–å…æ€ï¼Œæ¨¡å—æ”¹è¿›ï¼‰
# [åŸä»“åº“](https://github.com/kyxiaxiang/CobaltStrikeBeaconCppSource)å·²è¢«DMCA TAKEDOWN(https://github.com/Basyaact/CobaltStrikeBeaconDLLSourceLeaked-CSVersion2022-4.5/blob/main/DMCA2025-08-1615.51.48.png).
[English](#english) | [ä¸­æ–‡](#chinese)

## English

This repository contains the source code of CobaltStrike's Beacon, which is ready to use out of the box. I purchased this from China's Xianyu trading platform.

> **Note:** This branch is a cross-compiled version for **macOS**. For the Windows version, please check the [Windows branch](https://github.com/kyxiaxiang/CobaltStrikeBeaconCppSource).  
> This repository contains a ready-to-use **Cobalt Strike Beacon DLL** source code, purchased from the Chinese Xianyu trading platform.  
> Special thanks to the original author [@kyxiaxiang](https://github.com/kyxiaxiang) for the selfless contribution.

---

## ğŸ“œ Source

In 2022, the source code of the **Cobalt Strike 4.5 Beacon DLL** suddenly began circulating in underground Telegram channels.  
It was later sold at high pricesâ€”up to **3,500 RMB**â€”on Chinese second-hand platforms.  

This commercialized leak not only reflects the **strong demand for red team tools** but also exposes the risks of **weaponizing closed-source security software**.  

Now, with parts of the Beacon code made public, the security community finally has the opportunity to analyze its key techniques at the source levelâ€”such as:

- Thread injection
- Sleep obfuscation
- C2 communications

This marks a milestone for both **enhancing blue team detection capabilities** and **advancing the evolution of red team tools**.

---

## â“ Why Share? *(Original Authorâ€™s Words)*

> I decided to make this source code public because Iâ€™m tired of seeing people indirectly selling the Beacon source code in various ways for profit.  
> While this repository may eventually face a **DMCA takedown**, I believe that *when a whale falls, all creatures thrive* â€” everyone should have the chance to learn.  
>   
> I despise the shameless, repetitive cash-grabbing behavior some people have engaged in over the years. Itâ€™s time to end this cycle.

---

## ğŸ“¦ Dependencies

Using this source code requires:

1. [LibTomMath](https://github.com/libtom/libtommath)
2. [LibTomCrypt](https://github.com/libtom/libtomcrypt)
3. Manually decompile the JAR file
4. Replace the DLL file accordingly

> **Note:** Related dependency installation and compilation scripts can be executed in one step.  
> See [`install_lib.sh`](./install_lib.sh) for details.

---

## ğŸ¯ Purpose

I hope this code can:

1. Provide reference and suggestions for more open-source C2 projects
2. Promote the maturity of more open-source projects
3. Help improve AV/EDR detection capabilities
4. Contribute to cybersecurity

ğŸ’¡ Dedicated to all **red** and **blue** teams.

---

## âš ï¸ Disclaimer / å…è´£å£°æ˜

**This code is for educational and research purposes only.**  
The author assumes no responsibility for any misuse.

# å£°æ˜ï¼šè¿™ä¸ªä»“åº“éšæ—¶ä¼šè¢«DMCA TAKEDOWNï¼Œè¯·å°½å¿«Clone. 
# due to the nature of this repository, it may be subject to DMCA takedown at any time. Please clone it as soon as possible.
## Chinese
æ³¨æ„ï¼šæ­¤ç‰ˆæœ¬ä¸ºmacOSç‰ˆæœ¬çš„äº¤å‰ç¼–è¯‘åˆ†æ”¯ï¼ŒWindowsç‰ˆæœ¬è¯·æŸ¥çœ‹[Windowsåˆ†æ”¯](https://github.com/kyxiaxiang/CobaltStrikeBeaconCppSource)
è¿™ä¸ªä»“åº“åŒ…å«äº†å¼€ç®±å³ç”¨çš„CobaltStrike Beacon DLLæºä»£ç ï¼Œè´­ä¹°è‡ªä¸­å›½é—²é±¼äº¤æ˜“å¹³å°ï¼ˆåœ¨æ­¤æ„Ÿè°¢åŸä½œè€…@kyxiaxiangçš„æ— ç§è´¡çŒ®)ã€‚

### æ¥æº
2022å¹´CobaltStrike 4.5ç‰ˆæœ¬çš„Beacon DLLæºç çªç„¶åœ¨Telegramé»‘äº§æ¸ é“æµä¼ ï¼Œéšåç”šè‡³åœ¨ä¸­å›½äºŒæ‰‹å¹³å°æ ‡ä»·3500å…ƒé«˜ä»·æµé€šï¼Œè¿™ç§å•†ä¸šåŒ–æ³„éœ²æ—¢åæ˜ äº†çº¢é˜Ÿå·¥å…·çš„æ—ºç››éœ€æ±‚ï¼Œä¹Ÿæš´éœ²å‡ºé—­æºå®‰å…¨è½¯ä»¶è¢«æ­¦å™¨åŒ–çš„é£é™©ã€‚å¦‚ä»Šéšç€éƒ¨åˆ†Beaconä»£ç çš„å…¬å¼€ï¼Œå®‰å…¨ç¤¾åŒºç»ˆäºæœ‰æœºä¼šä»æºç å±‚é¢å‰–æå…¶çº¿ç¨‹æ³¨å…¥ã€ç¡çœ æ··æ·†ã€C2é€šä¿¡ç­‰å…³é”®æŠ€æœ¯ï¼Œè¿™å¯¹æå‡è“é˜Ÿæ£€æµ‹èƒ½åŠ›å’Œæ¨åŠ¨çº¢é˜Ÿå·¥å…·è¿›åŒ–éƒ½å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰ã€‚

### ä¸ºä»€ä¹ˆè¦åˆ†äº«ï¼Ÿ(åŸä½œè€…åŸæ–‡)

æˆ‘å†³å®šå…¬å¼€è¿™ä»½æºç ï¼Œå› ä¸ºæˆ‘çœ‹ä¸æƒ¯ä¸€äº›äººé€šè¿‡å„ç§æ–¹å¼å˜ç›¸å”®å–Beaconæºç æ¥ç‰Ÿåˆ©ã€‚è™½ç„¶è¿™ä¸ªä»“åº“æœªæ¥å¯èƒ½ä¼šé¢ä¸´DMCAä¸‹æ¶ï¼Œä½†æˆ‘ç›¸ä¿¡ä¸€é²¸è½ä¸‡ç‰©ç”Ÿ - æ¯ä¸ªäººéƒ½åº”è¯¥æœ‰å­¦ä¹ çš„æœºä¼šã€‚

æˆ‘å¾ˆé„™å¤·æŸäº›äººè¿™äº›å¹´æ¥æ¬ä¸çŸ¥è€»ã€ååå¤å¤çš„åœˆé’±è¡Œä¸ºã€‚æ˜¯æ—¶å€™ç»“æŸè¿™ä¸ªå¾ªç¯äº†ã€‚

### ä¾èµ–é¡¹

ä½¿ç”¨è¿™ä»½æºç éœ€è¦ï¼š
1. å‡†å¤‡ [LibTomMath](https://github.com/libtom/libtommath)
2. å‡†å¤‡ [LibTomCrypt](https://github.com/libtom/libtomcrypt)
3. è‡ªè¡Œåç¼–è¯‘jaræ–‡ä»¶
4. ç›¸åº”æ›¿æ¢DLLæ–‡ä»¶
æ³¨ï¼šç›¸å…³ä¾èµ–åº“å®‰è£…ä»¥åŠç¼–è¯‘çš„è„šæœ¬å¯ä¸€é”®å®Œæˆï¼Œå…·ä½“è¯·æŸ¥çœ‹[install_lib.sh]
### ç›®çš„

å¸Œæœ›è¿™ä»½ä»£ç èƒ½å¤Ÿï¼š
1. ä¸ºæ›´å¤šçš„å¼€æºC2é¡¹ç›®æä¾›å‚è€ƒå»ºè®®
2. ä¿ƒè¿›æ›´å¤šå¼€æºé¡¹ç›®çš„æˆç†Ÿ
3. å¸®åŠ©æå‡AV/EDRçš„æ£€æµ‹èƒ½åŠ›
4. ä¸ºç½‘ç»œå®‰å…¨åšå‡ºè´¡çŒ®

çŒ®ç»™å„ä½çº¢è“é˜Ÿã€‚

---

## Disclaimer / å…è´£å£°æ˜

This code is for educational and research purposes only. The author assumes no responsibility for any misuse.

æœ¬ä»£ç ä»…ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚ä½œè€…å¯¹ä»»ä½•æ»¥ç”¨è¡Œä¸ºä¸æ‰¿æ‹…è´£ä»»ã€‚
